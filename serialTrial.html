<!DOCTYPE html>
<html>
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <script src="https://unpkg.com/p5ble@0.0.7/dist/p5.ble.js" type="text/javascript"></script>
</head>
<body>
  <script>
    let ble;
    let potentiometerChar;
    let forceSensorChar;
    let potValue = 0;
    let forceValue = 0;

    function setup() {
      createCanvas(400, 400);
      background(220);
      
      // Create a p5ble class
      ble = new p5ble();

      const connectButton = createButton('Connect');
      connectButton.mousePressed(connectToBLE);
    }

    function connectToBLE() {
      // Connect to a device by passing the service UUID
      ble.connect('180C', gotCharacteristics);
    }

    function gotCharacteristics(error, characteristics) {
      if (error) {
        console.error('Error: ', error);
        return;
      }
      console.log('Characteristics: ', characteristics);
      potentiometerChar = characteristics[0];
      forceSensorChar = characteristics[1];
      
      // Start notifications on the first characteristic
      ble.startNotifications(potentiometerChar, handlePotValue, 'byte');
      ble.startNotifications(forceSensorChar, handleForceValue, 'byte');
    }

    function handlePotValue(value) {
      potValue = value;
      console.log('Potentiometer:', potValue);
    }

    function handleForceValue(value) {
      forceValue = value;
      console.log('Force Sensor:', forceValue);
    }

    function draw() {
      background(220);
      text('Potentiometer Value: ' + potValue, 10, 30);
      text('Force Sensor Value: ' + forceValue, 10, 60);
    }
  </script>
</body>
</html>
